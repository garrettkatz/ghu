Code used to generate results and figures in the paper:

"Reinforcement-based Program Induction in a Neural Virtual Machine"

We ran these experiments on a workstation with an 8-core Intel i7 CPU, 32GB of RAM, Fedora 30, Python 3.7.4, numpy 1.16.2, matplotlib 3.0.3, and pytorch 1.1.0.  With this configuration, the experiments took a matter of hours, with the longest experiments running and finishing overnight.  In a different configuration it may take longer or run out of memory.

The simplest script you can try is echo.py.  This will run one learning trial of the simplest echo task, with very small memory footprint, in a few seconds.

The paper figures were generated by the following scripts.  These scripts also rerun the experiments and regenerate the results data, but you can also use the existing data in this archive and just plot.  If you want to do both, regenerate and plot:

echo_experiments.py -> Figs 2,3
swap_experiments.py -> Figs 4,5
filter.py, rfilter.py, then plot_filters.py -> Fig 6
max.py, then plots.py -> Fig 7
recall_plastic.py, reverse_with_repeats.py, then big_experiments.py -> Figs 8-10

If you only want to plot, using the included data:

Comment out lines 78-82 in echo_experiments.py before running
Comment out lines 82-86 in swap_experiments.py before running
Just run plot_filters.py, plots.py, and big_experiments.py for the rest

For figs 8-10, we did individual runs of recall_plastic.py and reverse_with_repeats.py, which save results in pickle files with the same names and .pkl extension.  We manually prepended "_0", "_1", etc. to the filenames and then moved them to respective sub-directories of results/.  Finally, we used big_experiments.py to load the data and generate the plots, resetting the "num_reps" variable to the actual number of repetitions in each case.

There are also other experiments that can be run from this code but which we did not have space for in the paper:

echov2.py (task where "1" must be echoed once, "2" must be echoed twice, etc.)
recall.py (recall task but without any plasticity in the nvm-rl)
reverse.py (reverse task without any repeated list elements)

After running these scripts, plots can be generated by uncommenting the associated lines at the bottom of plots.py and running it.
